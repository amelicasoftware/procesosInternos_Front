<app-header></app-header>
<header class="toolbar" role="banner">
  <h1 class="subtitle title-page">{{title}}</h1>
  <div class="container-busqueda">
    <div class="column is-12 container-box-filter">
        <input [(ngModel)]="dataBusqueda.TITPROYINV" 
               class="input is-link box is-8" type="text" 
               (keypress)="eventHandler($event)"
               placeholder="Ingresa un titulo">
      <button type="submit" class="button is-4" (click)="prepareSearch()">buscar</button>
      <button class="button is-4" (click)="createNewRegister()">New register</button>
      <button class="button is-4" (click)="updateRegister()">Update register</button>
    </div>
    <div class="container-options-filter">
      <h4 class="subtitle">Restringe los resultados por:</h4>
    </div>
    <div class="column is-12 container-options">
      <div class="select">
        <select name="select-tipo" 
                [(ngModel)]="dataBusqueda.TPOPROYINV" 
                (change)="prepareSearch()">
          <option value="" disabled selected hidden>Tipo de proyecto</option>  
          <option [value]="item" *ngFor="let item of listaTipos">{{item}}</option>
        </select>
      </div>
      <div class="select">
        <select name="select-tipo" 
          [(ngModel)]="dataBusqueda.ALCPROYINV" 
          (change)="prepareSearch()">
          <option value="" disabled selected hidden>Alcance</option>  
          <option [value]="item" *ngFor="let item of listaAlcances">{{item}}</option>
        </select>
      </div>
      <div class="select">
        <select name="select-tipo" 
          [(ngModel)]="dataBusqueda.ANIOPROYINV" 
          (change)="prepareSearch()">
          <option value="" disabled selected hidden>Año</option>  
          <option [value]="item" *ngFor="let item of listaAnios">{{item}}</option>
        </select>
      </div>
      <div class="select">
        <select name="select-tipo" 
        [(ngModel)]="dataBusqueda.MESPROYINV" 
        (change)="prepareSearch()" >
          <option value="" disabled selected hidden>Mes</option>  
          <option [value]="item" *ngFor="let item of listaMeses">{{item}}</option>
        </select>
      </div>
      <div class="select select-periodo">
        <span>periodo</span>
        <div class="select">
          <select name="select-tipo" [(ngModel)]="dataBusqueda.PERIIN">
            <option value="" disabled selected hidden>Inicio</option>  
            <option [value]="item" *ngFor="let item of inicios">{{item}}</option>
          </select>
        </div>
        <select name="select-tipo" [(ngModel)]="dataBusqueda.PERIFIN">
          <option value="" disabled selected hidden>Fin</option>  
          <option [value]="item" *ngFor="let item of finales">{{item}}</option>
        </select>
      </div>
    </div>
  </div>
</header>
<body>
  <div class="column is-3 sidebarFilters" 
      id="sidebarFilters" 
      [ngStyle]="{'width': stateSidebar=='show' ? '300px' : '0',
              'color': stateSidebar=='show' ? 'white' : 'black',
              'padding': stateSidebar=='show' ? 'initial' : '0'}">
        <div class="column is-12 headFilters"
             [ngStyle]="{
                    'padding': stateSidebar=='show' ? '.5em .75em' : '0'}">
          <span [ngStyle]="{'display': stateSidebar=='show' ? 'initial' : 'none'}">Filtros de busqueda</span>
          <button class="card-header-icon button-sidebar" 
                  (click)="redimensionarSB()"
                  [ngStyle]="{
                    'padding': stateSidebar=='show' ? '0' : '0'}">
          <span class="icon">
              <i class="fas fa-bars" aria-hidden="true"></i>
          </span>
          </button>
        </div>
        <div class="column is-12 containerFiltros"
             [ngStyle]="{'display': stateSidebar=='show' ? 'initial' : 'none'}">
          <div class="filtro" *ngFor='let filtro of filtersData; index as i'>
            <div ng-if="filtro.elementos.length > 1">
                <h5 class="tit-filter">{{filtro.nombre}}:</h5>
                  <div class="{{i &lt; 5 ? 'elemento-filtro' : 'elemento-filtro-hidden'}}" *ngFor="let filter of filtro.elementos; index as j">
                    <label class="container-radio">
                         <input (click)="findWithFilters({tipo:filtro.nombre,nombre:filter.nombre})" type="checkbox" ng-checked="campoFiltrado({tipo:filtro.nombre,nombre:filter.nombre})"/>
                        {{filter.nombre}}
                      <span class="checkmark"></span>
                    </label>
                    <span>({{filter.total}})</span>
                   </div>
                   <label attr.id="mas-{{filtro.nombre}}" class="ver-mas-menos" (click)="clickListener('mas-'+filtro.nombre, true)" [ngStyle]="{'display': filtro.elementos.length &gt; 5 ? 'initial' : 'none'}">Ver mas...</label>
                   <label attr.id="menos-{{filtro.nombre}}" style="display:none;" class="ver-mas-menos" (click)="clickListener('menos-'+filtro.nombre, false)">Ver menos...</label>
                   <br/><br/>
            </div>
          </div>
        </div>
  </div>
  <div class="column is-12 container-cards-proy" 
       id="container-cards-proy" 
       [ngStyle]="{'width': stateSidebar=='show' ? '82%' : '100%',
                  'margin-left': stateSidebar=='show' ? '17%' : '0'}">
    <div class="card" *ngFor='let proyecto of data; index as i' attr.id="card{{proyecto.cveproyinv}}">
      <header class="card-header">
        <p class="card-header-title">
          Proyecto
        </p>
      </header>
      <div class="card-content">
        <div class="content">
          <span><b>Titulo:</b> {{proyecto.titproyinv}}</span><br>
          <span><b>Revista:</b> {{proyecto.fteproyinv}}</span><br>
          <span><b>DOI:</b> {{proyecto.urlproyinv}}</span><br>
          <span><b>Volumen:</b> {{proyecto.volproyinv}}</span><br>
          <span><b>Año:</b> {{proyecto.anioproyinv}}</span><br>
          <span><b>País:</b> {{proyecto.cvepaispro}}</span><br>
          <span><b>Autor:</b> {{proyecto.autproyinv}}</span><br>
        </div>
      </div>
      <footer class="card-footer">
        <a rel="nofollow" class="card-footer-item">Copiar cita</a>
        <a rel="nofollow" class="card-footer-item" (click)="generateImage('card'+proyecto.cveproyinv)">Descargar Imagen</a>
      </footer>
    </div>
  </div>
  <div class="table-container" id="table-container" style="font-size: 10px; display: none;">
    <table class="table">
      <thead>
        <tr>
          <th><abbr title="Position">Titulo</abbr></th>
          <th>Tipo de proyecto</th>
          <th><abbr title="Played">Año</abbr></th>
          <th><abbr title="Won">Mes</abbr></th>
          <th><abbr title="Drawn">Resumen</abbr></th>
          <th><abbr title="Lost">Autor</abbr></th>
          <th><abbr title="Goals for">Url</abbr></th>
          <th><abbr title="Goals against">Volumen</abbr></th>
          <th><abbr title="Goal difference">Fuente</abbr></th>
          <th><abbr title="Points">Institucion</abbr></th>
          <th>Autores participantes</th>
          <th>Participacion del proyecto</th>
          <th>País del proyecto</th>
          <th>Alcance</th>
          <th>Fecha de ultima modificacion</th>
          <th>Realizacion</th>
          <th>Agenda de proyecto</th>
          <th>Tipo de actividad</th>
          <th>Informacion adicional</th>
        </tr>
        
      </thead>
      
      <tbody style="width: 700px;">
        <tr *ngFor='let proyecto of data; index as i'>
          <td>{{proyecto.titproyinv}}</td>
          <td>{{proyecto.tpoproyinv}}</td>
          <td>{{proyecto.anioproyinv}}</td>
          <td>{{proyecto.mesproyinv}}</td>
          <td>{{proyecto.rsmproyinv}}</td>
          <td>{{proyecto.autproyinv}}</td>
          <td>{{proyecto.urlproyinv}}</td>
          <td>{{proyecto.volproyinv}}</td>
          <td>{{proyecto.fteproyinv}}</td>
          <td>{{proyecto.insproyinv}}</td>
          <td>{{proyecto.autpadproy}}</td>
          <td>{{proyecto.parproyinv}}</td>
          <td>{{proyecto.cvepaispro}}</td>
          <td>{{proyecto.alcproyinv}}</td>
          <td>{{proyecto.feccapproy}}</td>
          <td>{{proyecto.reaproyinv}}</td>
          <td>{{proyecto.agdredproy}}</td>
          <td>{{proyecto.tpoactproy}}</td>
          <td>{{proyecto.infadcproy}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</body>
<router-outlet></router-outlet>
