<div class="container is-widescreen">
  <form [formGroup]="form" class="box">
    <FONT class="obligatorio" COLOR="red">*Obligatorio</FONT><br><br>
    <div class="field">
      <label for="" class="label">Nombre de la red/grupo: <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <input
        class="input"
        type="text"
        formControlName="TITPROYINV"
        [ngClass]="{ 'is-danger': campoEsValido('TITPROYINV') }"
      />
      <p class="help is-danger" *ngIf="campoEsValido('TITPROYINV')">
        Este campo es obligatorio y no se permiten los caracteres: ?, ", #, /
      </p>
    </div>
    <div class="field">
      <label class="label">Instituciones participantes <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <div class="field has-addons">
        <div class="control has-icons-left">
          <input type="text" class="input" placeholder="Escribe el nombre de la institucion" [formControl]="institucion"
            (keyup.enter)="addIns(institucion.value, $event)">
          <span class="icon is-medium is-left">
            <i class="fa  fa-user"></i>
          </span>
        </div>
        <div class="control"  (click)="addIns(institucion.value, $event)">
          <button class="button is-info" [disabled]="institucion.errors && institucion.touched" >Agregar</button>
        </div>
      </div>
      <p class="help is-danger" *ngIf="campoEsValido('listIns')">
        Debe agregar por lo menos una institución
      </p>
      <p class="help is-danger" *ngIf="institucion.errors && institucion.touched">
        Este campo es obligatorio y no se permiten los caracteres: ?, ", #, /
      </p>
    </div>

    <label class="label" *ngIf="instArr.length > 0"
      >Lista de Instituciones</label
    >
    <div formArrayName="listIns">
      <div
        class="field has-addons"
        *ngFor="let institucion of instArr.controls; let i = index"
      >
        <div class="control has-icons-left">
          <input
            type="text"
            class="input"
            [formControlName]="i"
            readonly="readonly"
          />
          <span class="icon is-medium is-left">
            <i class="fa fa-user"></i>
          </span>
        </div>
        <div class="control" (click)="borrarInst(i)">
          <a class="button is-danger">Eliminar</a>
        </div>
      </div>
    </div>
    <div class="field">
      <label class="label">Países participantes: <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <ng-select
        class="select is-multiple"
        [multiple]="true"
        [formControl]="pais"
        [ngModel]="selectedCountry"
      >
        <ng-option *ngFor="let item of lista" [value]="item.cveentnac">{{
          item.nomentnac
        }}</ng-option>
      </ng-select>
      <p class="help is-danger" *ngIf="campoEsValido('CVEPAISPRO')">
        Debe agregar por lo menos un país
      </p>
    </div>
    <div class="field">
      <label class="label">Cantidad de integrantes:</label>
      <input
        class="input"
        type="text"
        formControlName="CTDINTPROY"
        [ngClass]="{ 'is-danger': campoEsValido('CTDINTPROY') }"
      />
      <p class="help is-danger" *ngIf="campoEsValido('CTDINTPROY')">
        Este campo solo acepta caracteres numericos de 1 al 10000
      </p>
    </div>
    <div class="field">
      <label class="label">Periodo:</label>
      <input class="input" type="text" formControlName="PRDPROYINV"
      placeholder="Junio - Agosto"
      [ngClass]="{ 'is-danger': campoEsValido('PRDPROYINV') }"
        />
        <span
          class="tag is-danger is-light"
          *ngIf="campoEsValido('PRDPROYINV')"
        >
          En este campo debe colocarse més de inicio y més de finalización
        </span>
    </div>
    <div class="field">
      <label class="label">Año <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <div class="control">
        <input
          type="number"
          class="input"
          placeholder=""
          formControlName="ANIOPROYINV"
          ngModel name="anioActual"
          [ngClass]="{ 'is-danger': campoEsValido('ANIOPROYINV') }"
        />
        <span
          class="tag is-danger is-light"
          *ngIf="campoEsValido('ANIOPROYINV')"
        >
        Este campo solo acepta caracteres numericos entre 1980 y {{anioAct}}
          <br />
        </span>
      </div>
    </div>
    
    <div class="field">
      <label class="label">Coordinadores: <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <div class="field has-addons">
        <div class="control has-icons-left">
          <input type="text" class="input" placeholder="Nombre del coordinador" [formControl]="autor"
            (keyup.enter)="addAutor(autor.value, apellidoAutor.value, $event)">
          <span class="icon is-medium is-left">
            <i class="fa  fa-user"></i>
          </span>
        </div>
        <div class="control has-icons-left">
          <input type="text" class="input" placeholder="Apellido del coordinador" [formControl]="apellidoAutor"
            (keyup.enter)="addAutor(autor.value, apellidoAutor.value, $event)">
          <span class="icon is-medium is-left">
            <i class="fa  fa-user"></i>
          </span>
        </div>
        <div class="control" (click)="addAutor(autor.value, apellidoAutor.value, $event)">
          <button class="button is-info"
            [disabled]="autor.errors && autor.touched && apellidoAutor.errors && apellidoAutor.touched">Agregar</button>
        </div>
      </div>
      <p class="help is-danger" *ngIf="campoEsValido('listAutor')">
        Debe agregar por lo menos un coordinador
      </p>
      <p class="help is-danger" *ngIf="autor.errors && autor.touched">
        Este campo es obligatorio y no se permiten los caracteres: {{signos}}
      </p>
    </div>
    <label class="label" *ngIf="autoresArr.length>0">Lista de Autores</label>
    <div formArrayName="listAutor">
      <div class="field has-addons" *ngFor="let autor of autoresArr.controls; let i = index">
        <div class="control has-icons-left">
          <input type="text" class="input" [formControlName]="i" readonly="readonly">
          <span class="icon is-medium is-left">
            <i class="fa  fa-user"></i>
          </span>
        </div>
        <div class="control" (click)="borrar(i)">
          <a class="button is-danger">Eliminar</a>
        </div>
      </div>
    </div>
    <div class="field">
      <label class="label">Síntesis:</label>
      <textarea
        class="textarea"
        cols="30"
        rows="5"
        formControlName="RSMPROYINV"
      ></textarea>
      <p class="help is-danger" *ngIf="campoEsValido('RSMPROYINV')">Este campo no admite los caracteres: ?, ", #, /</p>
    </div>
    <div class="field">
      <label class="label">Alcance <FONT class="obligatorio" COLOR="red">*</FONT></label>
      <div class="select" [ngClass]="{'is-danger' : campoEsValido('ALCPROYINV')}">
        <select formControlName="ALCPROYINV">
          <option value="Institucional">Institucional</option>
          <option value="Nacional">Nacional</option>
          <option value="Lationamérica">Lationamérica</option>
          <option value="Otras regiones">Otras regiones</option>
        </select>
      </div>
      <p class="help is-danger" *ngIf="campoEsValido('REAPROYINV')">Este campo es obligatorio</p>
    </div>
             <!-- ok -->
             <div class="field">
              <label class="label">¿El proyecto ya fue realizado? <FONT class="obligatorio" COLOR="red">*</FONT></label>
              <div class="control">
                <label class="radio">
                  <input type="radio" name="REAPROYINV" formControlName="REAPROYINV" value=1 (click)="deshabilitar()">
                  Si
                </label>
                <label class="radio">
                  <input type="radio" name="REAPROYINV" formControlName="REAPROYINV" value=0  (click)="habilitar()">
                  No
                </label>
              </div>
              <p class="help is-danger" *ngIf="campoEsValido('REAPROYINV')">Este campo es obligatorio</p>
            </div>
        
            <div class="field" *ngIf="des == true">
              <label class="label">¿Quisiera que este proyecto formara parte de la agenda de eventos de Redalyc? <FONT class="obligatorio" COLOR="red">*</FONT></label>
              <div class="control">
                <label class="radio">
                  <input type="radio" name="AGDREDPROY" formControlName="AGDREDPROY" value="si">
                  Si
                </label>
                <label class="radio">
                  <input type="radio" name="AGDREDPROY" formControlName="AGDREDPROY" value="no">
                  No
                </label>
              </div>
              <p class="help is-danger" *ngIf="campoEsValido('AGDREDPROY')">Este campo es obligatorio</p>
            </div>
         
           <!-- ok -->
           <div class="field">
            <label class="label">Información adicional: </label>
            <div class="control">
              <textarea class="textarea" placeholder="" formControlName="INFADCPROY"></textarea>
            </div>
            <p class="help is-danger" *ngIf="campoEsValido('INFADCPROY')">Sobrepasaste el limite de caracteres</p>
          </div>
         
             <div class="field is-grouped">
            <div class="control">
              <button class="button is-link" (click)="guardar()" *ngIf="!actualizacion">Guardar</button>
              <button class="button is-link" (click)="guardar()" *ngIf="actualizacion">Modificar</button>
            </div>
            <div class="control">
              <button class="button is-link is-light" (click)="limpiar()" *ngIf="!actualizacion">Cancelar</button>
              <button class="button is-link is-light" (click)="redirectConsultas()" *ngIf="actualizacion">Cancelar</button>
            </div>
          </div>
        </form>
      </div>

  <!--<span>Valid</span>
  <pre>{{ form.valid }}</pre>
  <br>
  
  <span>value</span>
  <pre>{{ form.value | json  }}</pre>
  <br>-->